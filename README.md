# Определение использования смартфона и других отвлекающих вещей/действий.

## Описание задачи
Создание системы контроля бдительности локомотивной бригады при управлении подвижным составом на основе нейросетевой аналитики, фиксация отвлечений от управления на мобильный телефон, личные электронные устройства, прочих отвлечений.

Задача ставилась в рамках Хакатона.

## Основная концепция решения
Человек видя только силует может с высокой долей вероятности сказать о том чем сейчас занимается другой человек. Так почему бы этому не обучить нейронную сеть? Именно эта идея и лежала в основе моего решения. Модель собирает ключевые точки, угол поворота головы по оси X,Y,Z, детектирует координаты смартфона, определяет кому именно принадлежат эти точки машинисту или помошнику. После этого данные передаются в простую полносвязную нейронную сеть и на выходе мы получаем оценку о действии сотрудника.

## Используемые технологии
Для определения наклона головы была использована WHENet (https://github.com/Ascend-Research/HeadPoseEstimation-WHENet). Для определения ключевых точек и детекции смартфона былв использована YOLO v8.

## Трудности
Ракурс. Он со спины. Проще всего было бы ориентироваться по лицу. Так же трудным было работать с таким количеством информации. После извлечения признаков надо было написать логику опредления и дальнейшую компановку всех данных в одну переменную. Звучит проще, чем собрать всё и ничего не потерять. Не стоит забывать и о пост обработке. Она тоже не совсем простая, хотя идея интуитивна, но не так легка в исполнении. Конечно не стоит забывать, что данные были без разметки. 
С учетом всего сказанного, данный проект заставил меня потрудиться.

## Результаты
Решение представляет из себя даже больше, чем просил заказчик. Ставилась задача детектировать отвлечение на смартфон, но наше решение еще детектирует наличие хотя бы одного человека в кабине, а так же факт фиксации, когда ни один из членов команды не смотрим на дорогу. На валидации модель очень не плохо себя показала. Порядка 85% точности.
