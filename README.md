# Система контроля бдительности локомотивной бригады на основе нейронных сетей. (2 место)

## Описание задачи
Разработка системы, способной контролировать бдительность локомотивной бригады в процессе управления подвижным составом. Основная цель - отслеживать моменты, когда бригада отвлекается на мобильный телефон, личные электронные устройства и прочие факторы, которые могут повлиять на безопасность движения.

## Основная концепция решения
Каждый из нас может с лёгкостью определить по силуэту человека, чем он занимается. Решено было применить этот принцип к обучению нейросети. Нейронная модель извлекает ключевые точки тела, учитывает наклон головы по разным осям и определяет, принадлежат ли эти данные машинисту или его помощнику. На основе этих данных, вторая часть системы оценивает текущее действие персонала.
![Пример работы](https://github.com/HeinrichWirth/distraction_detection/blob/main/image_example.jpg)

## Используемые технологии
- **WHENet:** Используется для определения наклона головы.
- **YOLO v8:** Применяется для детекции ключевых точек на теле человека и определения положения смартфона.

## Трудности
- **Ракурс камеры:** Изображение сзади ограничивает доступ к лицевой информации, которая могла бы облегчить задачу.
- **Обработка данных:** Необходимость агрегировать большой объем данных, исходя из различных факторов, создавала дополнительные трудности. Это включает в себя сбор, обработку и упаковку данных в удобоваримую форму.
- **Пост-обработка:** Несмотря на интуитивную ясность, реализация этапа пост-обработки была сложной.
- **Данные без разметки:** Отсутствие размеченных данных усложнило процесс обучения и валидации модели.

## Результаты
Разработанная система превзошла ожидания заказчика. Не только удается выявлять моменты, когда бригада отвлекается на смартфон, но также система может детектировать наличие хотя бы одного человека в кабине. Особо ценным является функция определения моментов, когда ни один из членов команды не смотрит на путь. При тестировании, модель продемонстрировала точность порядка 85%.

## Примечание
Для правильной работы системы необходимо загрузить соответствующую модель и сохранить ее в директории: distraction_detection\HeadPoseEstimation-WHENet-yolov4-onnx-openvino\saved_model_224x224\yolov4_headdetection_480x640.
